# ðŸ”„ Latest Code Changes

```diff
diff --git a/.github/workflows/gemini-cli.yml b/.github/workflows/gemini-cli.yml
index c6f115f..ca66afa 100644
--- a/.github/workflows/gemini-cli.yml
+++ b/.github/workflows/gemini-cli.yml
@@ -112,11 +112,14 @@ jobs:
             IS_PR="true"
           fi
 
-          # Clean up user request
+a          # Clean up user request
           USER_REQUEST=$(echo "${USER_REQUEST}" | sed 's/.*@gemini-cli//' | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')
 
+          # Write outputs safely (supporting newlines/special chars)
           {
-            echo "user_request=${USER_REQUEST}"
+            echo 'user_request<<EOF'
+            echo "${USER_REQUEST}"
+            echo 'EOF'
             echo "issue_number=${ISSUE_NUMBER}"
             echo "is_pr=${IS_PR}"
           } >> "${GITHUB_OUTPUT}"
@@ -216,16 +219,9 @@ jobs:
             echo "Prompt template not found: ${TEMPLATE_PATH}" >&2
             exit 1
           fi
-          # Safe variable substitution without executing content
-          EXPANDED=$(sed \
-            -e "s|\\$\\{REPOSITORY\\}|${REPOSITORY}|g" \
-            -e "s|\\$\\{EVENT_NAME\\}|${EVENT_NAME}|g" \
-            -e "s|\\$\\{ISSUE_NUMBER\\}|${ISSUE_NUMBER}|g" \
-            -e "s|\\$\\{IS_PR\\}|${IS_PR}|g" \
-            -e "s|\\$\\{DESCRIPTION\\}|${DESCRIPTION}|g" \
-            -e "s|\\$\\{COMMENTS\\}|${COMMENTS}|g" \
-            -e "s|\\$\\{USER_REQUEST\\}|${USER_REQUEST}|g" \
-            "${TEMPLATE_PATH}")
+          # Robust variable substitution using envsubst (handles braces/newlines safely)
+          # Limit substitution to specific variables to avoid accidental replacements
+          EXPANDED=$(envsubst '${REPOSITORY} ${EVENT_NAME} ${ISSUE_NUMBER} ${IS_PR} ${DESCRIPTION} ${COMMENTS} ${USER_REQUEST}' < "${TEMPLATE_PATH}")
           {
             echo "prompt<<EOF"
             echo "${EXPANDED}"
```
